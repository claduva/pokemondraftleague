{% extends "template.html" %}
{% load static %}
{% load crispy_forms_tags %}

{% block title %}{{ title }}{% endblock %}

{% block head %}
<link rel="stylesheet" type="text/css" href="{% static 'leagues/styles/leaguelist.css' %}">
{% endblock %}

{% block body %}
<div class="row content-section align-items-center">
    <div class="col-md-4">
        <div class="row">
            <div class="col-md-12 d-flex justify-content-center">
                <a href="{% url 'league_list' %}"><button class="btn btn-info">View Leagues</button></a>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="d-flex justify-content-center ">
            <img src="{% static 'main/images/pdllogo.png' %}" alt="" height=75px>
        </div>
    </div>
    <div class="col-md-4">
        <div class="row">
            <div class="col-md-12 d-flex justify-content-center">
                <a href="{% url 'league_list' %}"><button class="btn btn-info">Join A League</button></a>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12 d-flex justify-content-center">
                <a href="{% url 'create_league' %}"><button class="btn btn-info">Create A League</button></a>
            </div>
        </div>

    </div>
</div>
<div class="row">
    <div class="col-md-12 content-section">
        <h3>Your Teams</h3>
        <div class="row justify-content-around">
            {% for item in yourleagues %}
            <div class="col-md-2 m-0 p-0">
                <div class="card h-100 bg-lightgrey">
                    <a href="{% url 'team_page' league_name=item.league_name.name subleague_name=item.subleague.subleague team_abbreviation=item.teamabbreviation %}">
                        <div class="d-flex justify-content-center">
                            <img src="{{ item.logo.url }}" class="img-fluid mediumlogo m-1">
                        </div>
                        <div class="d-flex justify-content-center">
                            <h6 class="text-center">{{ item.teamname }}</h6>
                        </div>
                    </a>  
                    <a href="{% url 'league_detail' league_name=item.league_name.name %}"> 
                        <div class="d-flex justify-content-center border-top border-dark">
                            <h6 class="text-center">{{ item.league_name.name }} Homepage</h6>
                        </div>
                    </a>
                    <a href="{% url 'league_schedule' league_name=item.league_name.name subleague_name=item.subleague.subleague %}"> 
                        <div class="d-flex justify-content-center border-top border-dark">
                            <h6 class="text-center">Schedule</h6>
                        </div>
                    </a>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</div>
{% if upcomingmatches %}
<div class="row bg-darkgrey rounded p-3 mb-2 justify-content-around">
    <div class="col-md-12 m-0 p-0 text-light">
        <h4>Upcoming Matches</h4>
    </div>
    {% for item in upcomingmatches %}
    <div class="col-md-3 m-0 p-0">
        <div class="card h-100 bg-lightgrey text-center mx-1">
            <h5 class="p-0 m-0 mt-1">{{ item.season.league.name }}</h5>
            <h5 class="p-0 m-0">{%if 'Playoffs' not in item.week  %}Week {% endif %}{{ item.week }}</h5>
            {% if item.team1.coach == request.user %}
            <div><img class="mediumlogo rounded-circle" src="{{ item.team2.logo.url }}"></div>
            <div>{{item.team2.teamname}}</div>
            {% elif item.team2.coach == request.user %}
            <div><img class="mediumlogo rounded-circle" src="{{ item.team1.logo.url }}"></div>
            <div>{{item.team1.teamname}}</div>
            {% endif %}
            <a
                href="{% url 'league_matchup' league_name=item.season.league.name subleague_name=item.season.subleague.subleague matchid=item.id %}"><button
                    class="btn btn-dark mb-1">View Matchup</button></a>
            <a
                href="{% url 'upload_league_replay' league_name=item.season.league.name subleague_name=item.season.subleague.subleague matchid=item.id %}"><button
                    class="btn btn-dark mb-1">Upload Replay</button></a>
        </div>
    </div>
    {% endfor %}
</div>
{% endif %}
{% if recentresults %}
<div class="row bg-darkgrey rounded p-3 justify-content-around">
    <div class="col-md-12 m-0 p-0 text-light">
        <h4>Recent Results</h4>
    </div>
    {% for item in recentresults %}
    <div class="col-md-3 m-0 p-0">
        <div class="card h-100 bg-lightgrey text-center mx-1">
            <h5 class="p-0 m-0 mt-1">{{ item.season.league.name }}</h5>
            <h5 class="p-0 m-0">{%if 'Playoffs' not in item.week  %}Week {% endif %}{{ item.week }}</h5>
            {% if item.team1.coach == request.user %}
            <div><img class="mediumlogo rounded-circle" src="{{ item.team2.logo.url }}"></div>
            <div>{{item.team2.teamname}}</div>
            {% elif item.team2.coach == request.user %}
            <div><img class="mediumlogo rounded-circle" src="{{ item.team1.logo.url }}"></div>
            <div>{{item.team1.teamname}}</div>
            {% endif %}
            {% if item.winner.coach == request.user or item.winner.teammate == request.user  %}
            <div>WIN {{item.team1score}}-{{item.team2score}}</div>
            {% else %}
            <div>LOSE {{item.team1score}}-{{item.team2score}}</div>
            {% endif %}
            <a href="{{item.replay}}"><button class="btn btn-dark mb-1">Replay</button></a>
        </div>
    </div>
    {% endfor %}
</div>
{% endif %}
{% endblock %}